{"version":3,"sources":["components/NoAccess/NoAccess.js","store/firebase/hooks/customers/useWatchCustomer.js","routes/pages/CustomerManager.js","components/PaperContainerWithSpacing/types.js","components/PaperContainerWithSpacing/PaperContainerWithSpacing.js","store/firebase/hooks/customers/useCustomer.js"],"names":["NoAccess","children","ContainerWithCenteredItems","vertical","PaperContainerWithSpacing","Typography","variant","component","useWatchCustomer","id","designatedSalespersonId","useAuth","userId","isDesignatedSalesperson","useRoles","useFirestoreConnect","collection","doc","customerFromFirestore","useSelector","state","firestore","data","customers","customer","fromFirestore","pending","isLoaded","LoadingIndicator","error","isEmpty","CustomerManager","fullName","match","params","updateCustomer","useCustomer","firstName","lastName","vehicleSelection","PageContainer","PageTitle","icon","CustomersIcon","VehicleSelector","onVehicleSelectionUpdate","newSelection","customerInfo","object","bool","PaperWrapper","styled","Paper","theme","$bg","spacing","palette","main","background","paper","NoBgWrapper","div","shape","borderRadius","containerProps","paperProps","noBg","boxProps","useState","isHovering","setIsHovering","child","Box","py","px","textAlign","elevation","onMouseEnter","onMouseLeave","defaultProps","notifyError","useNotificationProvider","useFirestore","createCustomer","props","a","date","Date","add","toFirestore","createdOn","updatedOn","vehicleModel","exteriorColor","interiorColor","newId","update","deleteCustomer","customerId","delete"],"mappings":"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","file":"static/js/18.07f1b2da.chunk.js","sourcesContent":["import React from 'react';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\r\nimport PaperContainerWithSpacing from 'components/PaperContainerWithSpacing';\r\n\r\nconst NoAccess = ({ children }) => (\r\n\t<ContainerWithCenteredItems vertical>\r\n\t\t<PaperContainerWithSpacing>\r\n\t\t\t<Typography variant=\"h3\" component=\"h1\">\r\n\t\t\t\t{children}\r\n\t\t\t</Typography>\r\n\t\t</PaperContainerWithSpacing>\r\n\t</ContainerWithCenteredItems>\r\n);\r\n\r\nexport default NoAccess;\r\n","import { isEmpty, isLoaded, useFirestoreConnect } from 'react-redux-firebase';\r\nimport { useSelector } from 'react-redux';\r\n\r\nimport { fromFirestore } from 'store/firebase/utils';\r\nimport LoadingIndicator from 'components/LoadingIndicator';\r\nimport NoAccess from 'components/NoAccess';\r\nimport useAuth from '../useAuth';\r\nimport useRoles from '../useRoles';\r\n\r\nconst useWatchCustomer = id => {\r\n\tconst { userId: designatedSalespersonId } = useAuth();\r\n\tconst { isDesignatedSalesperson } = useRoles();\r\n\r\n\tuseFirestoreConnect({\r\n\t\tcollection: 'customers',\r\n\t\tdoc: id,\r\n\t\t// owner can see everyone\r\n\t\t// designated salesperson will have his customers linked\r\n\t\t// ...(isDesignatedSalesperson && {\r\n\t\t// \twhere: ['designatedSalespersonId', '==', userId],\r\n\t\t// }),\r\n\t});\r\n\r\n\tconst customerFromFirestore = useSelector(\r\n\t\tstate => state.firestore.data.customers\r\n\t);\r\n\r\n\tconst customer =\r\n\t\t(customerFromFirestore?.[id] &&\r\n\t\t\tfromFirestore(customerFromFirestore[id], ['vehicleSelection'])) ||\r\n\t\t{};\r\n\r\n\tconst pending = !isLoaded(customerFromFirestore) && <LoadingIndicator />;\r\n\tconst error =\r\n\t\t// empty\r\n\t\t(isEmpty(customerFromFirestore?.[id]) && (\r\n\t\t\t<NoAccess>\r\n\t\t\t\tEither the customer is not found or you don&apos;t have access\r\n\t\t\t\tto this page.\r\n\t\t\t</NoAccess>\r\n\t\t)) ||\r\n\t\t//  designated person is not linked to this customer\r\n\t\t(isDesignatedSalesperson &&\r\n\t\t\tcustomer?.designatedSalespersonId !== designatedSalespersonId && (\r\n\t\t\t\t<NoAccess>\r\n\t\t\t\t\tYou don&apos;t have access to view or update this customer.\r\n\t\t\t\t</NoAccess>\r\n\t\t\t));\r\n\treturn {\r\n\t\tcustomer,\r\n\t\tpending,\r\n\t\terror,\r\n\t};\r\n};\r\n\r\nexport default useWatchCustomer;\r\n","import PageContainer from 'components/page-components/PageContainer';\r\nimport { CustomersIcon } from 'icons';\r\nimport PageTitle from 'components/page-components/PageTitle';\r\nimport VehicleSelector from 'containers/VehicleSelector';\r\nimport useWatchCustomer from 'store/firebase/hooks/customers/useWatchCustomer';\r\nimport useCustomer from 'store/firebase/hooks/customers/useCustomer';\r\n\r\nconst CustomerManager = ({\r\n\tmatch: {\r\n\t\tparams: { id },\r\n\t},\r\n}) => {\r\n\tconst { error, pending, customer } = useWatchCustomer(id);\r\n\tconst { updateCustomer } = useCustomer(id);\r\n\r\n\tconst { firstName, lastName, vehicleSelection } = customer;\r\n\tlet fullName;\r\n\tif (firstName && lastName) {\r\n\t\tfullName = `${firstName} ${lastName}`;\r\n\t}\r\n\r\n\tconst onVehicleSelectionUpdate = newSelection => {\r\n\t\tupdateCustomer(newSelection);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<PageContainer>\r\n\t\t\t<PageTitle icon={CustomersIcon}>{fullName || 'Customer'}</PageTitle>\r\n\t\t\t{pending || error || (\r\n\t\t\t\t<VehicleSelector\r\n\t\t\t\t\tvehicleSelection={vehicleSelection}\r\n\t\t\t\t\tonVehicleSelectionUpdate={onVehicleSelectionUpdate}\r\n\t\t\t\t\tcustomerInfo={customer}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</PageContainer>\r\n\t);\r\n};\r\n\r\nexport default CustomerManager;\r\n","import { bool, object } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tcontainerProps: object,\r\n\tpaperProps: object,\r\n\tnoBg: bool,\r\n};\r\n\r\nconst defaultProps = {\r\n\tcontainerProps: {},\r\n\tpaperProps: {},\r\n\tnoBg: false,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React, { useState } from 'react';\r\nimport { Box, Paper } from '@material-ui/core';\r\nimport styled from 'styled-components';\r\n\r\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst PaperWrapper = styled(Paper)`\r\n\twidth: 100%;\r\n\ttext-align: left;\r\n\t${({ theme, $bg }) => `\r\n\t\t// margin-bottom: ${theme.spacing(2)}px;\r\n\t\tbackground-color: ${\r\n\t\t\t($bg &&\r\n\t\t\t\t(theme.palette[$bg]?.main ||\r\n\t\t\t\t\ttheme.palette.background[$bg] ||\r\n\t\t\t\t\t$bg)) ||\r\n\t\t\ttheme.palette.background.paper\r\n\t\t};\r\n\t`}\r\n`;\r\n\r\nconst NoBgWrapper = styled.div`\r\n\t${({ theme }) => `\r\n\t\t& * {\r\n\t\t\tborder-radius: ${theme.shape.borderRadius}px;\r\n\t\t}\r\n\t`}\r\n`;\r\n\r\nconst PaperContainerWithSpacing = ({\r\n\tcontainerProps,\r\n\tpaperProps,\r\n\tnoBg,\r\n\t...boxProps\r\n}) => {\r\n\tconst [isHovering, setIsHovering] = useState(false);\r\n\tconst onEnter = () => setIsHovering(true);\r\n\tconst onLeave = () => setIsHovering(false);\r\n\r\n\tconst child = <Box py={2} px={4} textAlign=\"left\" {...boxProps} />;\r\n\r\n\treturn (\r\n\t\t<ContainerWithCenteredItems {...containerProps}>\r\n\t\t\t{(noBg && <NoBgWrapper>{child}</NoBgWrapper>) || (\r\n\t\t\t\t<PaperWrapper\r\n\t\t\t\t\televation={(isHovering && 3) || 1}\r\n\t\t\t\t\tonMouseEnter={onEnter}\r\n\t\t\t\t\tonMouseLeave={onLeave}\r\n\t\t\t\t\t{...paperProps}\r\n\t\t\t\t>\r\n\t\t\t\t\t{child}\r\n\t\t\t\t</PaperWrapper>\r\n\t\t\t)}\r\n\t\t</ContainerWithCenteredItems>\r\n\t);\r\n};\r\n\r\nPaperContainerWithSpacing.propTypes = propTypes;\r\nPaperContainerWithSpacing.defaultProps = defaultProps;\r\n\r\nexport default PaperContainerWithSpacing;\r\n","import { useFirestore } from 'react-redux-firebase';\r\nimport useNotificationProvider from 'store/redux/hooks/useNotificationProvider';\r\nimport useAuth from 'store/firebase/hooks/useAuth';\r\nimport { toFirestore } from 'store/firebase/utils';\r\n\r\nconst useCustomer = id => {\r\n\tconst { notifyError } = useNotificationProvider();\r\n\tconst { userId: designatedSalespersonId } = useAuth();\r\n\r\n\tconst firestore = useFirestore({\r\n\t\tcollection: 'customers',\r\n\t\tdoc: id,\r\n\t});\r\n\r\n\tconst createCustomer = async props => {\r\n\t\ttry {\r\n\t\t\tconst date = new Date();\r\n\t\t\tconst { id: newId } = await firestore.add(\r\n\t\t\t\t'customers',\r\n\t\t\t\ttoFirestore({\r\n\t\t\t\t\t...props,\r\n\t\t\t\t\tcreatedOn: date,\r\n\t\t\t\t\tupdatedOn: date,\r\n\t\t\t\t\tvehicleSelection: {\r\n\t\t\t\t\t\tvehicleModel: null,\r\n\t\t\t\t\t\texteriorColor: null,\r\n\t\t\t\t\t\tinteriorColor: null,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdesignatedSalespersonId,\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t\treturn newId;\r\n\t\t} catch (err) {\r\n\t\t\tnotifyError(err);\r\n\t\t\treturn '';\r\n\t\t}\r\n\t};\r\n\r\n\tconst updateCustomer = async props => {\r\n\t\ttry {\r\n\t\t\tawait firestore.update(`customers/${id}`, toFirestore(props));\r\n\t\t} catch (err) {\r\n\t\t\tnotifyError(err);\r\n\t\t}\r\n\t};\r\n\r\n\tconst deleteCustomer = async (customerId = id) => {\r\n\t\ttry {\r\n\t\t\tawait firestore.delete(`customers/${customerId}`);\r\n\t\t} catch (err) {\r\n\t\t\tnotifyError(err);\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\tcreateCustomer,\r\n\t\tupdateCustomer,\r\n\t\tdeleteCustomer,\r\n\t};\r\n};\r\n\r\nexport default useCustomer;\r\n"],"sourceRoot":""}